- # 背景介绍
&emsp;&emsp;传统上，人们常通过GPS为代表的全球卫星导航系统（GNSS）进行定位，但这类系统在室内无法正常工作。此外，虽然基于蜂窝网络 (Cellular-Based) 的定位方案以及一些改进的GPS定位方案，如GPS辅助定位（Assisted-GPS，A-GPS）等可在一定程度上用于室内定位，但在精度、可用性等方面却无法满足大多数室内位置感知应用需求。在此背景下，出现了许多针对室内环境的定位技术，如Wi-Fi、UWB、RFID、Infrared、Bluetooth等。随着智能手机、平板电脑、笔记本电脑的普及，Wi-Fi也开始风靡全球，无线基础设施变得随处可见，相比UWB、ZigBee等无线技术，Wi-Fi更适用于普适室内环境中的定位应用，系统运营成本低廉，更容易普及和推广，因此基于 Wi-Fi的室内定位技术越来越受到关注。
&emsp;&emsp;目前基于Wi-Fi的室内定位系统多采用指纹定位方法。该方法分为离线和在线两个阶段。离线阶段，在选定的参考点位置上采集来自各接入点(Access Point，AP) 的RSS 值，以建立训练指纹库；在线阶段，将实时采集的RSS向量与指纹数据库比较，匹配出用户位置，常用的匹配算法有NN、KNN以及WKNN，Wi-Fi定位算法执行流程如下图所示。
![1](.\1.png)
- # 实现功能
&emsp;&emsp;(1) 在实验环境中划分参考点，通过移动终端（如手机、笔记本电脑）提取环境中Wi-Fi 信号（RSS值）指纹，建立指纹库（可存储到文件）；
&emsp;&emsp;(2) 设计实现NN、KNN以及WKNN匹配算法（选取一种进行实现，利用KNN以及WKNN实现可酌情加分，算法实现可参考文献[2006-Indoor Positioning Techniques Based on Wireless LAN]第4节，也可自行搜索其他资料；
![](.\2.png)

 - # 关键技术
（1）编写Android应用程序采集参考点处的Wi-Fi信号强度集；
（2）指纹匹配算法KNN和/或WKNN的实现。

- # 提示信息
&emsp;&emsp;大家可以加入自己的思考，尽量选取教室等开阔区域作为实验场景。
&emsp;&emsp;（1）指纹数据的构成。对于每一个指纹数据，我们需要录入环境中某个点的坐标（如下图中的8.698160171508789|14.563701629638672|1 分别代表X、Y以及Z坐标，中间用‘|’隔开），当前位置可以感知到的一组AP及其信号强度（RSS）(00:1a:1e:c7:d6:e2|-88  00:1a:1e:fd:6e:22|-90  00:1a:1e:c7:d6:12|-89 代表三个AP的MAC地址及其信号强度)
![3](.\3.png)
&emsp;&emsp;（2）测试数据的构成。测试数据与指纹数据构成形式上完全一样。每一行包括测试点的实际位置（定位前是未知的），以及一组AP及其RSS。设计的定位算法就是利用每个测试点（每一行）的一组AP及其RSS与指纹库进行匹配，以计算测试点的位置，然后计算得到的位置与实际位置进行比较，评估定位算法的性能。
![4](.\4.png)
&emsp;&emsp;（3）通过实验可以发现，不同位置采集到的指纹以及测试数据的AP集合不一样，如指纹库中{AP1|-30，AP2|-45，AP4|-54，AP5|-65}，{ AP1|-34，AP2|-44，AP5|-84，AP6|-49，} 测试点{AP1|-34，AP2|-90，AP3|-80，AP5|-73，AP6|-37}  {AP1|-34，AP2|-90， AP5|-73，AP6|-37}  从上图即可看出，一般文献中会忽略该问题。所以在设计实际可用的定位算法时，需要进行一个特殊的处理，使得进行匹配的两个AP集合完全相同，几种可行的处理方法：
>1）选取AP公共集进行匹配（推荐，比较简单），然后除以公共AP集个数求距离均值。如计算{AP1|-30，AP2|-45，AP4|-54，AP5|-65}与{ AP1|-34，AP2|-44，AP5|-84，AP6|-49}的信号距离，其实就是计算 {AP1|-30，AP2|-45， AP5|-65}与{ AP1|-34，AP2|-44，AP5|-84}的信号距离，然后除以3，得到最终的信号距离。
>2）求出所有指纹数据与测试数据AP集合的并集，所有的测试点与指纹点扩充到其并集，对于补充的AP的RSS赋一个较小值，如“-98“，对于上面的数据就变成了指纹库：{AP1|-30，AP2|-45，AP3|-98，AP4|-54，AP5|-65，AP6|-98}，{ AP1|-34，AP2|-44，AP3|-98，AP4|-98，AP5|-84，AP6|-49，} 测试点：{AP1|-34，AP2|-90，AP3|-80，AP4|-98，AP5|-73，AP6|-37}  {AP1|-34，AP2|-90，AP3|-98，AP4|-98， AP5|-73，AP6|-37}。
- # 参考文档
> [1] Li B, Salter J, Dempster A G, et al. Indoor positioning techniques based on wireless LAN[C]// IEEE International Conference on Lan. 2007:13--16.
> [2] 陈淼. 基于信号强度的WLAN室内定位跟踪系统研究[D]. 武汉大学, 2012.
> [3] S. He and S.-H. Chan, "Wi-Fi Fingerprint-based Indoor Positioning: Recent Advances and Comparisons,'' IEEE Communications Surveys and Tutorials, Vol. 18, pp. 466-490, First quarter 2016.


